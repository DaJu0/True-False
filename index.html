<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>True/False Addition Game</title>

<style>
html, body {
    margin: 0;
    height: 100%;
    font-family: "Times New Roman", Times, serif;
    color: white;
    font-weight: bold;
    -webkit-text-stroke: 1px black;
    text-shadow: 1px 1px 0 #000, -1px 1px 0 #000, 1px -1px 0 #000, -1px -1px 0 #000;
    transition: background 0.5s;
}

/* Rainbow animated background */
.rainbow-bg {
    background: linear-gradient(270deg, red, orange, yellow, green, blue, indigo, violet);
    background-size: 1400% 1400%;
    animation: rainbowBG 20s ease infinite;
}

/* Gray background for gameplay */
.game-bg {
    background: gray;
    animation: none;
}

@keyframes rainbowBG {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
}

#gameContainer {
    width: 100%;
}

#gameArea {
    margin-top: 20px;
}

#wrongCounter {
    font-size: 24px;
    margin-bottom: 10px;
    font-weight: bold;
}

#timer {
    font-size: 32px;
    font-weight: bold;
    margin-bottom: 15px;
}

#problem {
    font-size: 48px;
    margin: 10px 0 10px 0;
    font-weight: bold;
}

#feedback {
    font-size: 24px;
    margin-bottom: 15px;
    height: 30px;
    font-weight: bold;
}

button {
    margin: 10px;
    padding: 14px 28px;
    font-size: 22px;
    font-weight: bold;
    border-radius: 10px;
    cursor: pointer;
    background-color: rgba(255,255,255,0.2);
    color: white;
    -webkit-text-stroke: 1px black;
    text-shadow: 1px 1px 0 #000, -1px 1px 0 #000, 1px -1px 0 #000, -1px -1px 0 #000;
    border: 2px solid white;
    transition: 0.2s;
}

button:hover {
    background-color: rgba(255,255,255,0.4);
}

button:active {
    transform: scale(0.95);
    background-color: rgba(255,255,255,0.6);
}

/* START button specific */
button#startBtn {
    font-size: 28px;
    border-radius: 12px;
    animation: pulseStart 1.5s infinite;
}

/* START button pulse animation */
@keyframes pulseStart {
    0% { transform: scale(1); background-color: rgba(255,255,255,0.3); }
    50% { transform: scale(1.2); background-color: rgba(255,255,255,0.6); }
    100% { transform: scale(1); background-color: rgba(255,255,255,0.3); }
}

.hidden {
    display: none;
}

#endGameContainer {
    margin-top: 30px;
}

#gameDateTime {
    display: flex;
    justify-content: space-between;
    font-size: 20px;
    margin-bottom: 20px;
    padding: 0 40px;
}

/* Score pulse animation */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
}

#score {
    font-size: 36px;
    font-weight: bold;
    text-align: center;
    margin-top: 20px;
    animation: pulse 1s infinite;
}

/* Animated rainbow date and time */
@keyframes rainbowText {
    0% { color: red; }
    16% { color: orange; }
    32% { color: yellow; }
    48% { color: green; }
    64% { color: blue; }
    80% { color: indigo; }
    100% { color: violet; }
}

#gameDate, #gameTime {
    animation: rainbowText 3s linear infinite;
    font-weight: bold;
    font-size: 20px;
}

/* Rating percent below score */
#rating {
    font-size: 24px;
    font-weight: bold;
    margin-top: 10px;
}

/* Telegram share button same rainbow background as page */
#shareContainer {
    margin-top: 50px; /* Move button lower */
}

#shareContainer button {
    font-size: 20px;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    color: white;
    font-weight: bold;
    border: 2px solid white;
    /* Rainbow background exactly same as page */
    background: linear-gradient(270deg, red, orange, yellow, green, blue, indigo, violet);
    background-size: 1400% 1400%;
    animation: rainbowBG 20s ease infinite;
    transition: 0.2s;
}

#shareContainer button:hover {
    transform: scale(1.05);
}

/* DaJu text styling */
#daju {
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
}
</style>
</head>

<body class="rainbow-bg">

<div id="gameContainer">

    <div id="gameArea">

        <!-- Start button text -->
        <button id="startBtn" onclick="handleClick(startGame)">CLICK TO START</button>

        <div id="gameUI" class="hidden">
            <div id="wrongCounter">0/10</div>
            <div id="timer">2.10s</div>
            <div id="problem"></div>
            <div id="feedback"></div>
            <div id="choices">
                <button onclick="handleClick(() => selectAnswer(true))">True</button>
                <button onclick="handleClick(() => selectAnswer(false))">False</button>
            </div>
        </div>

        <div id="endGameContainer" class="hidden">
            <div id="gameDateTime">
                <div id="gameDate"></div>
                <div id="gameTime"></div>
            </div>
            <div id="score">üèÜ 0</div>
            <div id="rating"></div>
            <div id="shareContainer">
                <a id="shareTelegram" href="#" target="_blank">
                    <button>Share on Telegram</button>
                </a>
            </div>
            <div id="daju">DaJu</div>
        </div>

    </div>

</div>

<audio id="clickSound" src="https://freesound.org/data/previews/522/522808_10575057-lq.mp3"></audio>

<script>
let score = 0;
let wrongCount = 0;
let correctAnswer = true;
let timerId = null;
const answerTime = 2100;
let gameStartTime = null;
let countdownInterval = null;
const displayTime = 2.1;

function playClick() {
    const audio = document.getElementById("clickSound");
    audio.currentTime = 0;
    audio.play();
}

function handleClick(func) {
    playClick();
    func();
}

function formatDateTime(dateObj) {
    const dateOptions = { year: 'numeric', month: 'long', day: '2-digit' };
    const dateStr = dateObj.toLocaleDateString(undefined, dateOptions);

    let hours = dateObj.getHours();
    let minutes = dateObj.getMinutes();
    let ampm = hours >= 12 ? "PM" : "AM";
    hours = hours % 12 || 12;
    minutes = minutes < 10 ? "0" + minutes : minutes;

    const timeStr = `${hours}:${minutes} ${ampm}`;
    return { dateStr, timeStr };
}

function getRandomInt(max) {
    return Math.floor(Math.random() * max);
}

function updateWrongCounter() {
    document.getElementById("wrongCounter").innerText = `${wrongCount}/10`;
}

function newProblem() {
    if (wrongCount >= 10) {
        endGame();
        return;
    }

    clearTimeout(timerId);
    clearInterval(countdownInterval);

    let a = getRandomInt(10);
    let b = getRandomInt(10);

    correctAnswer = Math.random() < 0.5;
    let result = correctAnswer ? a + b : getRandomInt(20);

    document.getElementById("problem").innerText = `${a} + ${b} = ${result}`;
    document.getElementById("feedback").innerText = "";

    let timeLeft = displayTime;
    document.getElementById("timer").innerText = timeLeft.toFixed(2) + "s";

    countdownInterval = setInterval(() => {
        timeLeft -= 0.01;
        if (timeLeft <= 0) clearInterval(countdownInterval);
        document.getElementById("timer").innerText = Math.max(timeLeft,0).toFixed(2) + "s";
    }, 10);

    timerId = setTimeout(() => {
        wrongCount++;
        updateWrongCounter();
        document.getElementById("feedback").innerText = "HAHAHA üëéüèΩ";
        newProblem();
    }, answerTime);
}

function startGame() {
    score = 0;
    wrongCount = 0;
    updateWrongCounter();
    gameStartTime = new Date();

    document.body.classList.remove("rainbow-bg");
    document.body.classList.add("game-bg");

    document.getElementById("startBtn").classList.add("hidden");
    document.getElementById("gameUI").classList.remove("hidden");
    document.getElementById("endGameContainer").classList.add("hidden");

    newProblem();
}

function selectAnswer(answer) {
    clearTimeout(timerId);
    clearInterval(countdownInterval);

    const feedbackElem = document.getElementById("feedback");

    if ((answer === true && correctAnswer) || (answer === false && !correctAnswer)) {
        score++;
        feedbackElem.innerText = "Nice ka üëçüèΩ";
    } else {
        wrongCount++;
        updateWrongCounter();
        feedbackElem.innerText = "HAHAHA üëéüèΩ";
    }

    setTimeout(() => {
        if (wrongCount >= 10) endGame();
        else newProblem();
    }, 400);
}

function endGame() {
    clearTimeout(timerId);
    clearInterval(countdownInterval);

    document.getElementById("gameUI").classList.add("hidden");

    const { dateStr, timeStr } = formatDateTime(gameStartTime);
    document.getElementById("gameDate").innerText = dateStr;
    document.getElementById("gameTime").innerText = timeStr;

    document.getElementById("score").innerText = `üèÜ ${score}`;

    const totalAttempts = score + wrongCount;
    const ratingPercent = totalAttempts > 0 ? ((score / totalAttempts) * 100).toFixed(1) : 0;
    document.getElementById("rating").innerText = `Rating: ${ratingPercent}%`;

    const shareText = `I scored üèÜ ${score} points in the True/False Addition Game! Rating: ${ratingPercent}%`;
    document.getElementById("shareTelegram").href = `https://t.me/NOVEMBER_24_2022?text=${encodeURIComponent(shareText)}`;

    document.body.classList.remove("game-bg");
    document.body.classList.add("rainbow-bg");

    document.getElementById("endGameContainer").classList.remove("hidden");
}
</script>

</body>
</html>